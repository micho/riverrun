- title "Work: #{@work.name}"

%table#work_show
  - for piece in @work.pieces
    %tr
      %td.piece{ :id => piece.id }
        = piece.text || "Empty"
      %td.contents#ago
        = piece.text ? time_ago_in_words(piece.updated_at) : ''
      %td.contents#author
        = piece.user ? piece.user.username : "Unassigned"
      %td.actions
        - if piece.can_edit? current_user
          = link_to "Edit", edit_work_piece_path(@work, piece)

%p.actions
  - if @work.can_edit? current_user
    = link_to "Edit", edit_work_path(@work)
  - if @work.can_delete? current_user
    = link_to "Destroy", @work, :confirm => 'Are you sure?', :method => :delete
  = link_to "View All Works", works_path

%h2 Change log

%table#change_log
  - @work.change_log.each do |piece|
    - next if !piece.user_id and !piece.text
    %tr
      %td= time_ago_in_words piece.updated_at
      %td= piece.user_id ? User.find(piece.user_id).username : 'Unassigned'
      %td= piece.text